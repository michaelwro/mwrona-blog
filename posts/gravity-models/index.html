<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Earth Gravity Modelling - Michael Wrona&#39;s Blog</title><link rel="icon" type="image/png" href=/favicon.png /><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="Earth Gravity Modelling" />
<meta property="og:description" content="Contrary to popular belief, EARTH IS NOT FLAT. Earth&rsquo;s mean equatorial radius is about 6,378km and its mean polar radius is about 6,357km - a 21km difference! Earth&rsquo;s mountains, vallies, oceans, and varying sub-surface composition also contributes towards earth&rsquo;s irregular shape and therefore mass distribution." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mwrona.com/posts/gravity-models/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-14T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-01-14T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Earth Gravity Modelling"/>
<meta name="twitter:description" content="Contrary to popular belief, EARTH IS NOT FLAT. Earth&rsquo;s mean equatorial radius is about 6,378km and its mean polar radius is about 6,357km - a 21km difference! Earth&rsquo;s mountains, vallies, oceans, and varying sub-surface composition also contributes towards earth&rsquo;s irregular shape and therefore mass distribution."/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel="stylesheet">

	<link rel="stylesheet" type="text/css" media="screen" href="https://mwrona.com/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://mwrona.com/css/main.css" /><link rel="stylesheet" type="text/css" href="https://mwrona.com/css/dark.css"  />
	<link rel="stylesheet" type="text/css" href="https://mwrona.com/css/custom-dark.css"  />

	<script src="https://mwrona.com/js/feather.min.js"></script>
	
	<script src="https://mwrona.com/js/main.js"></script>

	<script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true,
        tags: 'ams'
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    };
  
    window.addEventListener('load', (event) => {
        document.querySelectorAll("mjx-container").forEach(function(x){
          x.parentElement.classList += 'has-jax'})
      });
  
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>

<body>
	<div class="container wrapper post">
		<div class="header">
	<h1 class="site-title"><a href="https://mwrona.com/">Michael Wrona&#39;s Blog</a></h1>
	<div class="site-description"><h2>Engineering, coding, tech, and other cool projects!</h2><nav class="nav social">
			<ul class="flat"><a href="https://www.youtube.com/channel/UCIeZzuXHGm7zqSFvT8xGoIQ" title="YouTube: @MicWro Engr" target="_blank" rel="noopener noreferrer"><i data-feather="youtube"></i></a><a href="https://github.com/michaelwro" title="GitHub: @michaelwro" target="_blank" rel="noopener noreferrer"><i data-feather="github"></i></a></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">Home</a>
			</li>
			
			<li>
				<a href="/posts">All Posts</a>
			</li>
			
			<li>
				<a href="/tags">Post Tags</a>
			</li>
			
			<li>
				<a href="/about">About</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post-header">
			<h1 class="title">Earth Gravity Modelling</h1>
			<div class="meta">Posted at &mdash; Jan 14, 2022</div>
		</div>

		<div class="markdown">
			<p>Contrary to popular belief, EARTH IS <em>NOT</em> FLAT. Earth&rsquo;s mean equatorial radius is about 6,378km and its mean polar radius is about 6,357km - a 21km difference! Earth&rsquo;s mountains, vallies, oceans, and varying sub-surface composition also contributes towards earth&rsquo;s irregular shape and therefore mass distribution. While this may seem unimportant for the average person, they are extremely important to consider for high-precision land, air, sea, and space navigation.</p>
<p>Equations of motion for ground vehicles, submarines, aircraft, rockets, missiles, and spacecraft use gravitational acceleration <code>$g$</code> in them.  and Therefore, high-precision navigation of the above vehicles depends on how accurately you can compute <code>$g$</code>.</p>
<p>The field of geodesy involves measuring and modelling earth&rsquo;s size, shape, mass distribution, and gravitational acceleration. If you&rsquo;ve taken any basic physics class, you probably know <code>$g$</code> as <code>$9.81m/s^2$</code> and never questioned it, as did I. This simple approximation works fine for back-of-the-napkin calculations, but as with most things in science and engineering, is not good enough for actual use. In this post, I&rsquo;ll introduce a relatively simple, yet accurate formula developed by geodesists to compute gravitational acceleration as a function of position and altitude.</p>
<h2 id="wgs84">WGS84</h2>
<p>Gravity as we all know it, <code>$g = 9.81 m/s^2$</code>, is derived from the World Geodetic System 1984 (WGS84) standard. WGS84 was developed by the US National Geospatial-Intelligence Agency to be a standard coordinate system and parameter set for cartography and geodesy. In fact, the WGS84 system is what GPS uses to define your latitude, longitude, and altitude. The WGS84 standard contains fundamental constants that define earth&rsquo;s shape and gravitational acceleration. WGS84 gravitational acceleration is <code>$g_0 = 9.80665 m/s^2$</code>. Round that to 2 decimal places, and you arrive at the familiar <code>$g = 9.81m/s^2$</code>.</p>
<h3 id="wgs84-constants">WGS84 Constants</h3>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Symbol</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Semi-Major Axis</td>
<td>a</td>
<td><code>$6378137 m$</code></td>
</tr>
<tr>
<td>Semi-Minor Axis</td>
<td>b</td>
<td><code>$6356752.314245 m$</code></td>
</tr>
<tr>
<td>Eccentricity</td>
<td>e</td>
<td><code>$0.0818191908426215$</code></td>
</tr>
<tr>
<td>Standard Grav. Accel.</td>
<td><code>$g_0$</code></td>
<td><code>$9.80665 m/s^2$</code></td>
</tr>
<tr>
<td>Gravitational Constant</td>
<td>GM</td>
<td><code>$3.986004418 * 10^{14} m^{3}/s^2$</code></td>
</tr>
</tbody>
</table>
<h2 id="things-that-affect-g">Things that Affect <code>$g$</code></h2>
<p>Before introducing the gravity model, it is beneficial to know what factors perturb <code>$g$</code>.</p>
<h3 id="altitude-losses">Altitude Losses</h3>
<p>As you travel farther away from earth, you&rsquo;ll begin to escape earth&rsquo;s gravity influence and <code>$g$</code> will decrease. In fact, gravity altitude losses follow an inverse-square law and are a function of altitude above mean sea level (MSL). According to the models I&rsquo;ll introduce in a bit, at 10km MSL, <code>$g$</code> will have decreased by about <code>$0.03 m/s^2$</code>. At 50km MSL, the loss is about <code>$0.15m/s^2$</code>. For non-precision applications near sea-level, this factor could be negligible, but for airliners, rockets, and spacecraft, altitude losses must be accounted for.</p>
<h3 id="earths-oblateness">Earth&rsquo;s Oblateness</h3>
<p>Earth&rsquo;s equatorial radius is about 21km greater than the polar radius due to earth&rsquo;s rotation (outwards centripetal force). This phenomena is called &lsquo;oblateness.&rsquo; In fact, <strong>earth&rsquo;s oblateness is the most significant gravitational perturbation.</strong> To explain why earth&rsquo;s oblateness affects <code>$g$</code>, we must assume a point mass approximation, where earth&rsquo;s mass is concentrated at a point at it&rsquo;s center. At the equator, we&rsquo;d be about 21km farther away from earth&rsquo;s center of mass compared to the poles. As described in the Altitude Losses section, this means <code>$g$</code> will less at the equator than at the poles. Oblateness effects are typically modelled as a function of latitude (and longitude in high fidelity models).</p>
<h2 id="modelling-altitude-losses">Modelling Altitude Losses</h2>
<p>Modelling altitude losses are the simplest. The following equation computes altitude loss as a function of altitude above MSL:</p>
<p><code>$$\Delta g(h) =  \frac{GM}{(a + h)^2} - \frac{GM}{a^2} \,\, m/s^2$$</code></p>
<p><code>$h$</code> is altitude above MSL, and values for <code>$GM$</code> and <code>$a$</code> can be found in the WGS84 table above. This equation is known as &ldquo;free air correction&rdquo; (FAC).</p>
<h2 id="gravity-models">Gravity Models</h2>
<p>The two most popular gravity models are Helmert&rsquo;s equation and the WGS84 model.</p>
<h3 id="helmerts-equation">Helmert&rsquo;s Equation</h3>
<p>Helmert&rsquo;s equation is also known as the <a href="https://en.wikipedia.org/wiki/Theoretical_gravity#Basic_formulas">International Gravity Formula</a>. It computes <em>MSL</em> gravitational acceleration as a function of geodetic latitude <code>$\phi$</code>.</p>
<p><code>$$ g(\phi) = 9.780327 \left[1 + 0.0053024\sin^{2}(\phi) - 0.0000058\sin^{2}(2\phi)\right]\ \, m/s^{2} $$</code></p>
<h3 id="wgs84-gravity-model">WGS84 Gravity Model</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Theoretical_gravity#Somigliana_equation">WGS84 gravity model</a> coefficients are derived from WGS84 constants. It also computes <em>MSL</em> gravitational acceleration as a function of geodetic latitude.</p>
<p><code>$$ g(\phi) = 9.780325335903891718546\left[{\frac {1+0.00193185265245827352087\sin ^{2}(\phi )}{\sqrt {1-0.006694379990141316996137\sin ^{2}(\phi )}}}\right]\ \, m/s^{2}$$</code></p>
<h2 id="combining-equations">Combining Equations</h2>
<p>The two gravity models compute gravitational acceleration at sea level. To accound for altitude above MSL, you must apply the free air corrections. Simply add the free air correction equation to Helmert&rsquo;s equation or the WGS84 model. I&rsquo;ll use Helmert&rsquo;s equation as an example.</p>
<p><code>$$ g(\phi, h) = g(\phi) + \Delta g(h) $$</code></p>
<p><code>$$ g(\phi, h) = 9.780327 \left[1 + 0.0053024\sin^{2}(\phi) - 0.0000058\sin^{2}(2\phi)\right] + \left(\frac{GM}{(a + h)^2} - \frac{GM}{a^2}\right) \,\, m/s^{2} $$</code></p>
<h1 id="final-remarks">Final Remarks</h1>
<p>Both of these equations are pretty accurate approximations compared to higher fidelity gravity models. Personally, I would feel comfortable using these equations for altitudes less than 70 km. For higher altitude applications, I would use a more accurate gravity model. Have fun using this in your projects!</p>

		</div>

		<div class="post-tags">
			
				
					<nav class="nav tags">
							<ul class="flat">
								
								<li><a href="/tags/sensors">sensors</a></li>
								
							</ul>
					</nav>
				
			
		</div>

		<div class="utternces-comments">
			<script src="https://utteranc.es/client.js"
    repo="michaelwro/mwrona-blog"
    issue-term="pathname"
    label="post comment"
    theme="github-dark"
    crossorigin="anonymous"
    async>
</script>
		</div>
		</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div> Copyright © Michael Wrona 2022 |  Powered by <a href="https://gohugo.io">Hugo</a> and the <a href="https://github.com/vividvilla/ezhil">Ezhil theme</a></div>
	</nav>
</div>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-176773333-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

<script>feather.replace()</script>
</body>
</html>
